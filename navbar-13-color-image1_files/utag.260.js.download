//tealium universal tag - utag.260 ut4.0.202509191407, Copyright 2025 Tealium.com Inc. All Rights Reserved.
if(!window.RB){window.RB=window.RB||{};RB.queue=RB.queue||[];RB.track=RB.track||function(){RB.queue.push(Array.prototype.slice.call(arguments))};RB.initialize=function(s){RB.source=s};}
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;u.ev={"view":1,"link":1};u.initialized=false;u.map={"order_id":"order_id","order_subtotal":"revenue","product_style_number":"view_product.products","product_sku":"conv.add_to_cart.products,conv.initiate_checkout.products,conv.purchase.one_time.products","rbx_event:add_to_cart":"conv.add_to_cart","rbx_event:view_product":"view_product","rbx_event:email_signup":"conv.email_signup","rbx_event:sms_signup":"sms_signup","rbx_event:create_account":"conv.create_account","rbx_event:log_in":"log_in","rbx_baseUrl":"base_url","rbx_email":"email","customer_id":"external_id","order_hashed_email":"conv.purchase.one_time.email"};u.extend=[function(a,b){try{if(1){if(/dev|qa/.test(b["ut.env"])){u.data.base_url="https://staging2.urbanoutfitters.com/urbn.wxyz.js";}else{u.data.base_url="https://www.urbanoutfitters.com/urbn.wxyz.js";}
function buildTrackingData(b,eventName){const data={};const addIfValid=(key,value)=>{if((value||value===false)&&value!==''&&!(Array.isArray(value)&&(value.length===0||(value.length===1&&value[0]==='')))){data[key]=typeof value==='boolean'?value:value.toString();}};addIfValid('email',b.rbx_email);addIfValid('client_id',b.uuid);addIfValid('site_id',b["cp.urbn_site_id"]);let continent='';if(b["cp.urbn_site_id"]&&(b["cp.urbn_site_id"]=='uo-uk'||b["cp.urbn_site_id"]=='uo-fr'||b["cp.urbn_site_id"]=='uo-de'||b["cp.urbn_site_id"]=='uo-it'||b["cp.urbn_site_id"]=='uo-es')){continent='EUROPE';}else{continent='NORAM';}
addIfValid('continent',continent);if(b.customer_auth_status=='AUTHORIZED'&&(eventName!=='conv.log_in'&&eventName!=='conv.create_account')){addIfValid('external_id',b.customer_id);}
addIfValid('customer_type',b.customer_auth_status);if(b.customer_auth_status&&b.customer_auth_status.includes('CALL_CENTER')){addIfValid('ignore_user_events',true);}else{addIfValid('ignore_user_events',false);}
let productID="";if(eventName=='conv.view_product'&&b.product_style_number){productID=b.product_style_number;}else if(b.product_sku){productID=b.product_sku;}
const productData=[{productId:productID,sku:b.product_id||urbn?.vendor?.product_id,name:b.product_name||urbn?.vendor?.product_name,priceValue:b.product_selling_price||urbn?.vendor?.product_selling_price,quantity:b.product_quantity||urbn?.vendor?.product_quantity,brand:b.product_brand||urbn?.vendor?.product_brand,category:b.product_type_attribution||urbn?.vendor?.product_type_attribution},];const items=[];for(const productItem of productData){if(productItem.productId&&Array.isArray(productItem.productId)){for(let i=0;i<productItem.productId.length;i++){const product={'PRODUCT_ID':productItem.productId[i]||'','NAME':productItem.name[i]||'','PRICE':productItem.priceValue[i]||'','QUANTITY':productItem.quantity[i]||'','BRAND':productItem.brand[i]||'','CATEGORY':productItem.category[i]||''};items.push(product);}}}
if(eventName!=="identify"&&items.length>0){addIfValid('products',JSON.stringify(items));}
if(eventName==="conv.purchase"&&b.order_id&&b.order_subtotal){addIfValid('order_id',b.order_id);addIfValid('revenue',b.order_subtotal);addIfValid('coupon',b.order_promo_code);addIfValid('currency',b.urbn_currency);addIfValid('address_city',b.customer_city);addIfValid('address_state',b.customer_state);addIfValid('address_zip_code',b.customer_postal_code);}
return data;}
function trackEvent(condition,eventName){if(condition&&window.RB){const trackingData=buildTrackingData(b,eventName);if(eventName=="view"){RB.track(eventName);}else{RB.track(eventName,trackingData);}}}
trackEvent(b.page_type==="product"&&a==="view","conv.view_product");trackEvent(b.event_action===("add to cart"||"family | add to cart")||b.event_name=="add_to_cart","conv.add_to_cart");trackEvent(a==="view","view");trackEvent(a==="view","identify");trackEvent(b.event_category==="checkout"&&b.event_name==="begin_checkout","conv.initiate_checkout");trackEvent(a==="view"&&b.page_type==="receipt","conv.purchase");trackEvent(b.event_action==="create an account submit"||b.event_name==="sign_up","conv.create_account");trackEvent(b.event_action==="marketing signup complete"||b.event_name==="marketing_sign_up"||b.event_name=="submitEmail","conv.email_signup");trackEvent(b.event_name==="submitSMS"||b.event_label==="sms opt in success","conv.sms_signup");trackEvent(b.event_action==="sign in submit"||b.event_name==="login","conv.log_in");}}catch(e){utag.DB(e)}}];u.toBoolean=function(val){val=val||"";return val===true||val.toLowerCase()==="true"||val.toLowerCase()==="on";};u.mapFunc=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.mapFunc(arr,obj[i],item);}else{obj[i]=item;}};u.clearEmptyKeys=function(object){Object.keys(object).forEach(function(key){if(object[key]===""||object[key]===undefined){delete object[key];}});return object;};u.loaderCallback=function(){u.initialized=true;if(u.toBoolean(u.data.automatic_pageview)){RB.track("view");}
u.sendEvents();}
u.sendEvents=function(){u.data.events.forEach(function(eventName){var eventData={order_id:u.data.order_id,revenue:u.data.revenue,coupon:u.data.coupon,email:u.data.email,external_id:u.data.external_id,rb_country:u.data.rb_country,rb_state:u.data.rb_state,rb_city:u.data.rb_city,rb_address_1:u.data.rb_address_1,rb_address_2:u.data.rb_address_2,rb_zip_code:u.data.rb_zip_code}
if(u.data.products&&u.data.products.length){eventData.products=JSON.stringify(u.data.products);}
var eventNameSplitted=eventName.split('.');var eventSpecificParams={};eventNameSplitted.forEach(function(key,index){if(index===0){eventSpecificParams=u.data[key]||{};return;}
if(!eventSpecificParams[key]){eventSpecificParams={};return;}
eventSpecificParams=eventSpecificParams[key];});utag.ut.merge(eventData,eventSpecificParams,1);RB.track(eventName,u.clearEmptyKeys(eventData));});}
u.send=function(utag_event,data_layer){if(u.ev[utag_event]||u.ev.all!==undefined){var a,b,c,d,e,f;a=utag_event;b=data_layer;u.data={base_url:"https://www.urbanoutfitters.com/urbn.wxyz.js",disablePushState:'true',automatic_pageview:'false',client_auth:'dXJiYW5vdXRmaXR0ZXJzfHZpZXd8cHVyY2hhc2V8c2lnbnVwfGxvZ2lu',external_id:'',order_id:'',revenue:'',coupon:'',products:[],email:'',rb_country:'',rb_state:'',rb_city:'',rb_address_1:'',rb_address_2:'',rb_zip_code:'',events:[]};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};c=[];Object.keys(utag.loader.GV(u.map)).forEach(function(mapping_key){if(data_layer[mapping_key]!==undefined&&data_layer[mapping_key]!==''){var destinations=u.map[mapping_key].split(',');destinations.forEach(function(parameter){u.mapFunc(parameter.split('.'),u.data,data_layer[mapping_key]);});}else{var event_destinations=mapping_key.split(':');if(event_destinations.length===2&&String(data_layer[event_destinations[0]])===String(event_destinations[1])){if(u.map[mapping_key]){u.data.events=u.data.events.concat(u.map[mapping_key].split(','));}}}});utag.DB('send:260:MAPPINGS');utag.DB(u.data);var eCommerceMapping=[{eCommerceData:data_layer._corder,name:'order_id',isArray:false},{eCommerceData:data_layer._ctotal,name:'revenue',isArray:false},{eCommerceData:data_layer._cpromo,name:'coupon',isArray:false},{eCommerceData:data_layer._cprod,name:'products',isArray:true}];eCommerceMapping.forEach(function(dataObject){if(!dataObject.isArray){u.data[dataObject.name]=u.data[dataObject.name]||dataObject.eCommerceData||'';}else if(u.data[dataObject.name].length===0&&dataObject.eCommerceData!==undefined&&dataObject.isArray){u.data[dataObject.name]=dataObject.eCommerceData.slice(0);}});RB.disablePushState=u.toBoolean(u.data.disablePushState);RB.initialize(u.data.client_auth);if(u.initialized){u.sendEvents();}else{utag.ut.loader({type:"script",src:u.data.base_url,loc:"script",id:"utag_260",cb:u.loaderCallback()});}
}};utag.o[loader].loader.LOAD(id);}("260","urbanoutfitters.a15-uoweb"));}catch(error){utag.DB(error);}
